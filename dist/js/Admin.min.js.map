{"version":3,"sources":["Admin.js"],"names":["$","document","undefined","param","attr","token","csrf","data","jQuery","html","modal","extend","backdrop","options","on","this","find","focus","remove","$li","parent","hasClass","length","toggleClass","removeClass","parents","children","$this","height","$alerts","types","Alert","text","type","delay","arguments","_classCallCheck","init","_createClass","key","value","render","delayClose","$alert","_this2","_this","appendTo","close","setTimeout","addClass","_this3","clearTimeout","timer","alert","deleted","id","url","$modal","prop","success","method","d","error","message","location","reload","_new","_setData","call","$new","$parent","before","max","siblings","clone","removeAttr","isNew","get","hide","$text","$button","notImg","$hidden","$img","val","name","e","$add","show","prevAll","each","$file","append"],"mappings":"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","file":"Admin.min.js","sourcesContent":["/*!\n * admin\n * xiewulong <xiewulong@vip.qq.com>\n * create: 2016/8/2\n * version: 0.0.2\n */\n\n// csrf\n(($, document, undefined) => {\n\tlet param\t= $('meta[name=csrf-param]').attr('content'),\n\t\ttoken\t= $('meta[name=csrf-token]').attr('content');\n\n\t$.csrf = (data) => {\n\t\tdata = data || {};\n\t\tdata[param] = token;\n\n\t\treturn data;\n\t};\n\n})(jQuery, document);\n\n// modal\n(($, document, undefined) => {\n\n\t$.modal = (html, options) => {\n\t\t// html sample\n\t\t// '<div class=\"modal fade\">' +\n\t\t// \t'<div class=\"modal-dialog\">' +\n\t\t// \t\t'<div class=\"modal-content\">' +\n\t\t// \t\t\t'<div class=\"modal-header\">' +\n\t\t// \t\t\t\t'<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' +\n\t\t// \t\t\t\t'<h4 class=\"modal-title\">Modal title</h4>' +\n\t\t// \t\t\t'</div>' +\n\t\t// \t\t\t'<div class=\"modal-body\">' +\n\t\t// \t\t\t\t'<p>One fine body&hellip;</p>' +\n\t\t// \t\t\t'</div>' +\n\t\t// \t\t\t'<div class=\"modal-footer\">' +\n\t\t// \t\t\t\t'<button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>' +\n\t\t// \t\t\t\t'<button type=\"button\" class=\"btn btn-primary\">Save changes</button>' +\n\t\t// \t\t\t'</div>' +\n\t\t// \t\t'</div>' +\n\t\t// \t'</div>' +\n\t\t// '</div>';\n\n\t\treturn $(html).modal($.extend({backdrop: 'static'}, options)).on('shown.bs.modal', function() {\n\t\t\t$(this).find('[autofocus=autofocus]').focus();\n\t\t}).on('hidden.bs.modal', function() {\n\t\t\t$(this).remove();\n\t\t});\n\t};\n\n})(jQuery, document);\n\n// dropdown\n(($, document, undefined) => {\n\n\t$(document).on('click', '.J-admin-header .menu > ul.main > li > .text', function() {\n\t\tlet $li\t= $(this).parent('li');\n\n\t\tif(!$li.hasClass('dropdown-hover') && $li.find('ul.dropdown, ul.dropdown-mixed').length) {\n\t\t\t$li.toggleClass('dropdown-open');\n\n\t\t\treturn false;\n\t\t}\n\t}).on('click', function() {\n\t\t$('.J-admin-header .menu > ul.main > li.dropdown-open').removeClass('dropdown-open');\n\t});\n\n})(jQuery, document);\n\n// sidebar\n(($, document, undefined) => {\n\n\t$(document).on('click', '.J-admin-sidebar .sidebar-control', function() {\n\t\t$(this).parents('.J-admin-sidebar').toggleClass('admin-sidebar-fold');\n\t}).on('click', '.J-admin-sidebar ul.sidebar > li > .text', function() {\n\t\tlet $li\t= $(this).parent('li');\n\n\t\t$li.children('ul.children').length && $li.toggleClass('fold');\n\t});\n\n\t$('.J-admin-sidebar ul.sidebar > li > ul.children').each(function() {\n\t\tlet $this = $(this);\n\n\t\t$this.height($this.height());\n\t});\n\n})(jQuery, document);\n\n// alert\n(($, document, undefined) => {\n\tlet $alerts\t= $('.J-admin-alerts'),\n\t\ttypes\t= ['success', 'danger', 'info', 'warning'];\n\n\tclass Alert {\n\n\t\tconstructor(text, type, delay = 3000) {\n\t\t\tthis.text = text;\n\t\t\tthis.type = types[type];\n\t\t\tthis.delay = delay;\n\n\t\t\treturn this.init();\n\t\t}\n\n\t\tinit() {\n\t\t\tthis.render();\n\t\t\tthis.delayClose();\n\n\t\t\treturn this.$alert;\n\t\t}\n\n\t\trender() {\n\t\t\tlet _this\t= this;\n\n\t\t\tthis.$alert = $(\t'<div class=\"alert alert-' + this.type + ' alert-dismissible\">' +\n\t\t\t\t\t\t\t\t\t'<button type=\"button\" class=\"close\"><span>&times;</span></button>' +\n\t\t\t\t\t\t\t\t\tthis.text +\n\t\t\t\t\t\t\t\t'</div>').appendTo($alerts)\n\t\t\t\t.on('click', '.close', function() {\n\t\t\t\t\t_this.close();\n\t\t\t\t}).on('webkitTransitionend transitionend', function() {\n\t\t\t\t\t!_this.$alert.hasClass('alert-show') && _this.remove();\n\t\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.$alert.addClass('alert-show');\n\t\t\t}, 0);\n\t\t}\n\n\t\tdelayClose() {\n\t\t\tthis.timer = setTimeout(() => {\n\t\t\t\tthis.close();\n\t\t\t}, this.delay);\n\t\t}\n\n\t\tclose() {\n\t\t\tclearTimeout(this.timer);\n\t\t\tthis.$alert.removeClass('alert-show');\n\t\t}\n\n\t\tremove() {\n\t\t\tthis.$alert.remove();\n\t\t}\n\n\t}\n\n\t$.alert = function(text, type, delay) {\n\t\tif(type === undefined || type === true) {\n\t\t\ttype = 1;\n\t\t} else if(type === false) {\n\t\t\ttype = 0;\n\t\t}\n\n\t\treturn new Alert(text, type, delay);\n\t}\n\n})(jQuery, document);\n\n// delete modal\n(($, document, undefined) => {\n\n\t$(document).on('click', '[data-delete]', function() {\n\t\tlet deleted, $modal,\n\t\t\t$this\t= $(this),\n\t\t\tid\t\t= $this.attr('data-delete'),\n\t\t\turl\t\t= $this.attr('href') || $this.attr('data-url');\n\n\t\tif(!id || !url) return;\n\n\t\t$modal = $.modal(\t'<div class=\"modal fade\">' +\n\t\t\t\t\t\t\t\t'<div class=\"modal-dialog\">' +\n\t\t\t\t\t\t\t\t\t'<form class=\"modal-content\">' +\n\t\t\t\t\t\t\t\t\t\t'<fieldsed>' +\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"modal-header\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<h5 class=\"modal-title\">删除提示</h5>' +\n\t\t\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"modal-body\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<p>您确定要删除吗？</p>' +\n\t\t\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"modal-footer\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">取消</button>' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<button type=\"submit\" class=\"btn btn-primary\">确定</button>' +\n\t\t\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t\t\t'</fieldsed>' +\n\t\t\t\t\t\t\t\t\t'</form>' +\n\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t'</div>');\n\n\t\t$modal.on('submit', 'form', function() {\n\t\t\tlet $fieldset\t= $(this).find('fieldset').prop('disabled', true);\n\n\t\t\t$.ajax({\n\t\t\t\turl: url,\n\t\t\t\tdata: $.csrf({id: id}),\n\t\t\t\tmethod: 'post',\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess: (d) => {\n\t\t\t\t\tif(!d.error) {\n\t\t\t\t\t\tdeleted = true;\n\t\t\t\t\t}\n\t\t\t\t\t$modal.modal('hide');\n\t\t\t\t\t$.alert(d.message, d.error);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}).on('hidden.bs.modal', function() {\n\t\t\tdeleted && window.location.reload();\n\t\t});\n\n\t\treturn false;\n\t});\n\n})(jQuery, document);\n\n// attachment upload\n(($, document, undefined) => {\n\n\t$(document).on('uploaded.attachment.file', '.J-admin-attachment input[type=file]', function(e, d) {\n\t\tif(d.error) {\n\t\t\t$.alert(d.message);\n\n\t\t\treturn false;\n\t\t}\n\n\t\t$(this).parent().attr('data-attachment-max') === undefined ? _setData.call(this, d.data) : _new.call(this, d.data);\n\t\t$.alert(d.message, d.error);\n\t}).on('click', '.J-admin-attachment i', function() {\n\t\tlet $add, max,\n\t\t\t$parent\t= $(this).parent();\n\n\t\tif($parent.hasClass('admin-attachments')) {\n\t\t\t$add = $parent.siblings('[data-attachment-max]');\n\t\t\tmax = + $add.attr('data-attachment-max');\n\t\t\tmax > 0 && $parent.siblings('.admin-attachments').length < max && $add.show();\n\t\t\t$parent.remove();\n\n\t\t\treturn false;\n\t\t}\n\n\t\t$parent.find('input[type=hidden]').val('');\n\t\t$parent.find('img, i, p').remove();\n\t}).on('click', '[data-attachment-max]', function() {\n\t\tlet $this\t= $(this),\n\t\t\tmax\t\t= + $this.attr('data-attachment-max');\n\n\t\tif(max > 0 && $this.prevAll('.admin-attachments').length >= max) {\n\t\t\t$.alert('最多只能添加' + max + '张图片', 3);\n\n\t\t\treturn false;\n\t\t}\n\t});\n\n\t$('.J-admin-attachment').each(function() {\n\t\tlet $this\t= $(this),\n\t\t\t$hidden\t= $this.find('input[type=hidden]'),\n\t\t\t$file\t= $this.find('input[type=file]'),\n\t\t\tdata\t= {id: $hidden.val(), name: $hidden.attr('data-name')};\n\n\t\tdata.id && _setData.call($file.get(0), data);\n\t\t$this.hasClass('admin-attachment-name') && $this.append('<a href=\"javascript:;\">点击上传文件</a>');\n\t});\n\n\tfunction _new(data) {\n\t\tlet $this\t= $(this),\n\t\t\t$parent\t= $this.parent(),\n\t\t\tmax\t\t= + $parent.attr('data-attachment-max');\n\t\t\t$new \t= $parent.clone().removeAttr('data-attachment-max').removeClass('glyphicon-plus').addClass('glyphicon-picture admin-attachments');\n\n\t\t_setData.call($new.find('input[type=file]').get(0), data, true);\n\t\t$parent.before($new);\n\t\tmax > 0 && $parent.siblings('.admin-attachments').length >= max && $parent.hide();\n\t}\n\n\tfunction _setData(data, isNew) {\n\t\tlet $this\t\t= $(this),\n\t\t\t$parent\t\t= $this.parent(),\n\t\t\t$hidden\t\t= $parent.find('input[type=hidden]'),\n\t\t\t$img\t\t= $parent.find('img'),\n\t\t\t$text\t\t= $parent.find('p'),\n\t\t\t$button\t\t= $parent.find('a'),\n\t\t\tnotImg\t\t= $parent.hasClass('admin-attachment-name');\n\n\t\tif(!$hidden.length) {\n\t\t\t$hidden = $('<input type=\"hidden\" name=\"' + $this.attr('data-attachment-upload') + '\" />').appendTo($parent);\n\t\t}\n\t\tif(!notImg && !$img.length) {\n\t\t\t$img = $('<img />').appendTo($parent);\n\t\t}\n\t\tif(!$parent.find('i').length) {\n\t\t\t$parent.append('<i class=\"glyphicon glyphicon-remove\"></i>');\n\t\t}\n\t\tif(notImg && !$text.length) {\n\t\t\t$text = $('<p></p>').appendTo($parent);\n\t\t}\n\t\t$hidden.val(data.id);\n\t\tif(notImg) {\n\t\t\t$hidden.attr('data-name', data.name);\n\t\t\t$text.html(data.name);\n\t\t} else {\n\t\t\t$img.attr('src', $this.attr('data-attachment-load-action') + '?id=' + data.id);\n\t\t}\n\t\tisNew && $this.remove();\n\t}\n\n})(jQuery, document);\n"],"sourceRoot":"/source/"}