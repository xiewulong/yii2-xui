{"version":3,"sources":["Admin.js"],"names":["$","document","undefined","param","attr","token","csrf","data","jQuery","html","modal","extend","backdrop","options","on","this","find","focus","remove","$li","parent","hasClass","length","toggleClass","removeClass","parents","children","$this","height","$alerts","types","Alert","text","type","delay","arguments","_classCallCheck","init","_createClass","key","value","render","delayClose","$alert","_this2","_this","appendTo","close","setTimeout","addClass","_this3","clearTimeout","timer","alert","deleted","id","url","$modal","prop","success","method","d","error","message","location","reload","_new","_setData","call","$new","$parent","before","max","siblings","clone","removeAttr","isNew","get","hide","$text","$button","notImg","$hidden","$img","val","name","e","$add","show","prevAll","each","$file","append","Tags","_this4","obj","inputTemplate","ids","$obj","$list","push","events","_this5","newInput","$input","originalEvent","submit","cancel","press","like","$span","index","indexOf","splice","clearDropdown","selectedId","$target","down","$dropdown","classname","sibling","$selected","$first","pressDownIndex","unselect","len","tag","list","css","offset","top","offsetHeight","end","i","exists","current","tags","join","selected","post","inArray","add","ajax","dataType"],"mappings":"8XAQA,SAAEA,EAAGC,EAAUC,GACd,GAAIC,GAAQH,EAAE,yBAAyBI,KAAK,WAC3CC,EAAQL,EAAE,yBAAyBI,KAAK,UAEzCJ,GAAEM,KAAO,SAACC,GAHV,MAFDA,GAAAA,MACCA,EAAAJ,GAAIF,EAEHI,IAGAE,OAAOA,UAGP,SAAAP,EAAAC,EAAAC,GARFF,EAWGQ,MAAQP,SAAAA,EAAAA,GAoBT,MAAAD,GAAAS,GAAAC,MAAAV,EAAAW,QAAAC,SAAA,UAAAC,IAAAC,GAAA,iBAAA,WACAd,EAAAe,MAAAC,KAAA,yBAAAC,UACAH,GAAA,kBAAA,WACAd,EAAAe,MAAAG,aAEOV,OAEDP,UAGN,SAzBDD,EAAAC,EAAAC,GAgCAF,EAAEC,GAAUa,GAAG,QAAS,+CAAgD,WAHzE,GAAAK,GAAAnB,EAAAe,MAAAK,OAAA,KAME,KAAID,EAAIE,SAAS,mBAAqBF,EAAIH,KAAK,kCAAkCM,OAGhF,MANArB,GAAAA,YAAa,kBAMN,IAFPkB,GAAII,QAAAA,WAKLvB,EAAE,sDAAsDwB,YAAY,oBATrEhB,OAQMP,UAIN,SAdDD,EAcGQ,EAAQP,GAEXD,EAAAC,GAAAa,GAAA,QAAA,oCAAA,WACCd,EAAAe,MAAAU,QAAIxB,oBAAwBsB,YAAA,wBAIzBT,GAAG,QAAS,2CAA4C,WAF3Dd,GAAEC,GAAFD,EAAYc,MAAGM,OAAS,KAAxBD,GAAAO,SAAA,eAEeJ,QAAAH,EAAAI,YAAA,UAGdJ,EAAAA,kDAA0CI,KAAY,WALvD,GAAAI,GAAA3B,EAAAe,KAQAf,GAAE4B,OAAAD,EAAAC,aAGDD,OAAMC,UAMR,SAAE5B,EAAGC,EAAUC,GADf,GAAA2B,GAAA7B,EAAA,mBACC8B,GAAC9B,UAAD,SAAcE,OAAc,WAE3B4B,EAF2B,WAAA,QAAAC,GAAAC,EAAAC,GAAA,GAAAC,GAAAC,UAAAb,QAAA,GAAAa,UAAA,KAAAjC,EAAA,IAAAiC,UAAA,EAW1B,OAX0BC,iBAAArB,KAAAgB,GAM3BhB,KAAAiB,KAAAA,EAAsCjB,KAAdmB,KAAcJ,EAAAG,GAGrClB,KAAKmB,MAAQA,EAENnB,KAAKsB,OAXc,MAAAC,cAAAP,IAAAQ,IAAA,OAAAC,MAAA,WAkB1B,MAHAzB,MAAK0B,SAJL1B,KAAA2B,aAOO3B,KAAK4B,UAlBcJ,IAAA,SAAAC,MAAA,WAAA,GAAAI,GAAA7B,KAe1B8B,EAAA9B,IASAA,MAAK4B,OAAS3C,EAAG,2BAA6Be,KAAKkB,KAAO,wFAL1DlB,KAAAiB,KAnB0B,UAAAc,SAAAjB,GAAAf,GAAA,QAAA,SAAA,WAAA+B,EAAAE,UAqBlBjC,GAAA,oCAAA,YAUL+B,EAAMF,OAAOtB,SAAS,eAAiBwB,EAAM3B,WAPhD8B,WAAKL,WAKHE,EAAAA,OAAAI,SAAA,eALY,MAxBYV,IAAA,aAAAC,MAAA,WAuCd,GAAAU,GAAAnC,IALZiC,MAAAA,MAAWA,WAAM,WAChBE,EAAAH,SADDhC,KAAAmB,UAlC0BK,IAAA,QAAAC,MAAA,WAAAW,aAAApC,KAAAqC,OAuCdrC,KAAA4B,OAAAnB,YAAA,iBAvCce,IAAA,SAAAC,MAAA,WA0CzBzB,KAAE4B,OAAKT,aA1CkBH,IA8C1BoB,GAAAA,MAAAA,SAAanB,EAAKoB,EAAlBlB,GAMA,MALAD,KAAKU,GAALV,KAAwB,EACxBA,EAAA,EAhD0BA,KAAA,IAAAA,EAAA,GAoD1B,GAAAF,GAAAC,EAAAC,EAAAC,KApD0B1B,OAAAP,UAwD5BD,SAAAA,EAAEqD,EAAQnD,GAER+B,EAAAA,GAAAnB,GAAA,QAAA,gBAAA,WACA,GAFDwC,GAAAA,OAEUrB,EAAAA,OACTA,EAAAjC,EAAAe,MACAwC,EAAA5B,EAAAvB,KAAA,eAcAoD,EAAO7B,EAAMvB,KAAK,SAAWuB,EAAMvB,KAAK,WAnB1C,IAAAmD,GAAAC,EAuEA,MAhDCC,GAASzD,EAAEU,MAAO,2gBAyBhBH,EAAAA,GAAQD,SAAMiD,OAFR,WAAAvD,EAAAe,MAAAC,KAAA,YAAA0C,KAAA,YAAA,EAmBR,OAdEC,GAAAA,MACCH,IAAGA,EACFF,KAAAA,EAAAA,MAAUC,GAAVA,IACAK,OAAA,OACDH,SAAO/C,OACPV,QAAQ6D,SAAAA,GACRA,EAAAC,QAXFR,GAAA,GAcAG,EAAO/C,MAAP,QACEI,EAlBHuC,MAkBMQ,EAAAE,QAAAF,EAlBNC,WAsBO,IAlDRhD,GAAA,kBAAA,WAqDEN,GAAQP,OAvDX+D,SAAAC,YA0DC,KAGCzD,OAAKsD,UAGJ,SAAA9D,EAAAC,EAAAC,GAyCF,QAASgE,GAAK3D,GAMb4D,GAAAA,GAASC,EAAKC,MACdC,EAAQC,EAAOF,SACfG,GAAAF,EAAWA,KAAQG,uBACnBJ,EAAAC,EAAAI,QAAAC,WAAA,uBAAAnD,YAAA,kBAAAyB,SAAA,sCAEDkB,GAASA,KAAAA,EAAS5D,KAAMqE,oBAAOC,IAAA,GAAAtE,GAAA,GAC9B+D,EAAI3C,OAAW0C,GAAfG,EACCF,GAAAA,EAAW3C,SADZ,sBAAAL,QAAAkD,GAAAF,EAAAQ,OAAA,QAICC,GAAST,EAAQtD,GAJlB,GAKCgE,GAAAA,EAAWV,MALZA,EAMCW,EAAUX,SAJVY,EAAWZ,EAAQtD,KAAK,sBAMzBmE,EAAID,EAAQ5D,KAAQ,OACnB4D,EAAAA,EAAYlE,KAAA,KAEbiE,GADCX,EAAAtD,KAAA,KACEsD,EAAYa,SAAf,yBAECD,GAAA5D,SACD4D,EAAIZ,EAAQtD,8BAAkBW,EAAAvB,KAAA,0BAAA,QAAA0C,SAAAwB,IAE7BW,GAAAE,EAAA7D,SACD6D,EAAGF,EAAAA,WAAiB3D,SAAQgD,IAE3BA,EAAAtD,KAAA,KAAAM,QACD4D,EAAQE,OAAI7E,8CAEX2E,IAAaH,EAAAzD,SACbyD,EAAMtE,EAAN,WAAAqC,SAAAwB,IAEAa,EAAK/E,IAAKG,EAAVgD,IACA0B,GACDL,EAASjD,KAAAA,YAATpB,EAAA8E,MACAN,EAAAtE,KAAAF,EAAA8E,OAHCF,EAAK/E,KAAK,MAAOuB,EAAMvB,KAAK,+BAAiC,OAASG,EAAKgD,IAQ7EqB,GAAC5E,EAAGC,SA1FJD,EAAEC,GAAUa,GAAG,2BAA4B,uCAAwC,SAASwE,EAAGzB,GAO9F7D,MAAE6D,GAAAC,OACF9D,EAAEqD,MAAMQ,EAAEE,UAENwB,IAHJvF,EAAEe,MAAMK,SAAShB,KAAK,yBAA2BF,EAAYiE,EAASC,KAAKrD,KAAM8C,EAAEtD,MAAQ2D,EAAKE,KAAKrD,KAAM8C,EAAEtD,UAM7GP,GAAAqD,MAAGiB,EAAAA,QAAQjD,EAASyC,UACnByB,GAAAA,QAAOjB,wBAAiB,WACxBE,GAAAA,GAAAA,OAAQe,EAAAA,OACRf,EAAAxE,EAAWsE,MAAAA,QAHZ,OAAGA,GAAQjD,SAAS,sBAMnBkE,EAAOjB,EAAPG,SAAA,yBACAD,GAAAe,EAAAnF,KAAA,uBAJAoE,EAAM,GAAKF,EAAQG,SAAS,sBAAsBnD,OAASkD,GAAOe,EAAKC,OAMxElB,EAAQtD,UAEH,IAFLsD,EAAQtD,KAAK,sBAAsBoE,IAAI,QAMvCd,GAAGE,KAAA,aAAiBiB,YACnBzF,GAAEqD,QAAM,wBAAR,WAJD,GAAI1B,GAAQ3B,EAAEe,MAMbyD,GAAO7C,EAAPvB,KAAA,sBA/BF,IAAAoE,EAAA,GAAA7C,EAAA8D,QAAA,sBAAAnE,QAAAkD,EAoCC,MAPCxE,GAAEqD,MAAM,SAAWmB,EAAM,MAAO,IAO7B7C,IADL3B,EAAE,uBAAuB0F,KAAK,WAM7BnF,GAAAA,GAAW4D,EAAAA,MACXxC,EAAMN,EAASL,KAAA,sBAPhB2E,EAAAhE,EAAAX,KAAA,oBAIET,GAAQgD,GAAI2B,EAAQE,MAAOC,KAAMH,EAAQ9E,KAAK,aAO/CG,GAAIoB,IAAAA,EAAJyC,KAAAuB,EAAAd,IAAA,GAAAtE,GAAAoB,EACC2C,SAAU3C,0BADXA,EAAAiE,OAAA,wCAgDiBpF,OAAAP,UAJnB,SAAED,EAAGC,EAAUC,GAAc,GAM1B2F,GAN0B,WAQ1B,QAAAA,GAAKb,GAAU,GAAAc,GAAA/E,IAAAqB,iBAAArB,KAAA8E,GACf9E,KAAKyC,KAAMxD,EAAA+F,GACXhF,KAAKsE,MAAOtE,KAAKiE,KAAAA,KAAQ5E,KACzBW,KAAKiF,KAAAA,KAAAA,KAAgBhF,KAAA,QACrBD,KAAKkF,QAAOlF,KAAAsD,KAAMrD,KAAA,UACjBD,KAAIkF,IAAMlF,KAAVmF,KAAA9F,KAAA,aACAW,KAAAsE,KAAKc,KAAMnF,QAAKZ,KAAA,iBACf6F,KAAAA,cAAgBzD,kEAChBzB,KAFDkF,IAAA,WADA,GAAIA,KASL,OAJCH,GAAAK,MAAAnF,KAAA,2BAAA0E,KAAA,WANUO,EAAXG,MAAArF,KAAAyB,SAUAyD,KAtB0BlF,KAAAsF,SAAA,MAAA/D,cAAAuD,IAAAtD,IAAA,SAAAC,MAAA,WAwBlB,GAAA8D,GAAAvF,KACR8B,EAAIA,IACJ9B,MAAAmF,KAAApF,GAAA,QAAA,cAAA,WACCwF,EAAAC,WACAD,EAAAtB,QAAKA,OACLsB,EAAAE,OAAKA,SAAO1D,EAASuB,MAAKA,UAH3BvD,GAAA,UAAA,aAAA,SAI+BwE,GAC9B,OAAAA,EAAOA,cAAEmB,SACR,IAAA,IACC,MAAAH,GAAOI,QAER,KAAA,IACCJ,EAAAK,QACA,MACD,KAAA,IACCL,EAAAM,OAAKA,EACL,MACD,KAAA,IACCN,EAAAM,OAAKA,MAhBR9F,GAAA,cAAA,aAAA,WAoBCwF,EAAAO,SApBD/F,GAAA,QAAA,WAAA,WAsBC,GAAAgG,GAAIA,EAAQ9G,MAAAoB,OAAA,QAAZ2F,EACCA,EAAQlE,IAAMoD,SAAIe,EAAUF,KAAM9F,sBAAKoE,MAExC2B,IAAAA,GAAAlE,EAAcA,IAAAoE,OAAAF,EAAA,GAEdD,EAAAA,QAAA,WACCA,EAAAA,aAIF9G,EAAAA,GAAAc,GAAA,QAAA,WACCwF,EAAAY,qBA3DyB3E,IAAA,WAAAC,MAAA,WAAAzB,KAAAoG,WAAA,QAAA5E,IAAA,SAAAC,MAAA,SAAA4E,GAAArG,KAAAoG,WAAAC,EAAAnE,SAAA,YAAA7C,KAAA,cAAAmC,IAAA,QAAAC,MAAA,SAqE1B6E,GArE0B,GAAAtG,KAAAuG,UAAA,CAAA,GAAAF,GAAAA,OAwE1BG,EAASD,WAIRE,EAAWH,EAAO,OAAS,OAF5BI,EAAIL,KAAAA,UAAJpG,KAAA,MAAAuG,GAAAG,EACCH,KAAAA,UAAYvG,KADb,OAAAqG,EAAA,QAAA,QAAAI,GAGCA,QAHDA,EAICC,YAAeJ,GAGfG,EADDA,EAAGA,GAAkB,MAAAnG,OACVE,EAAAA,GAAY+F,MAEnBE,GAGFL,EAAAA,EAGDA,KAAAA,OAAUM,OAzFenF,IAAA,gBAAAC,MAAA,WA6F1BzB,KAAAuG,YA7F0BvG,KAAAuG,UAAApG,SAAAH,KAAAuG,UAAA,KAgG1BvG,KAAG4G,eAAiB,EAKpB5G,KAAK6G,eArGqBrF,IAAA,WAAAC,MAAA,SAoGrBmF,GACL,GAAAE,GAAKD,EAALtG,MArG0B,KAAAuG,EAyG1B,WAzG0B9G,MAAAmG,eA4GzBnG,MAAA6G,UAEA,IAAAE,GAAAA,OACAC,KAMAC,EAAOjH,KAAKyF,OAAOyB,SAJpBzF,EAAKoF,KAALpB,OAAApB,MAMCvC,EAAQ9B,IAJTiH,GAAAE,KACCH,KADDvB,OAAA3B,IAAA,GAAAsD,aAAApH,KAGCyB,UAAQzB,KAAKyF,WAHdxG,EAAA,qCAAA8C,SAAA,QAAAhC,GAAA,QAAA,KAAA,WAAA+B,EAICA,QAAQ7C,EAJTe,MAAAX,KAAA,cAUGU,GAAG,aAAc,KAAM,WAJ1BkH,EAAIE,WAAY1B,EAAAA,MAAWvD,SAAGkF,YAA9B1D,SAAA,aAAAjD,YAAA,YAAA4G,MAAAhI,KAAA,aAEAW,KAAAuG,UAAAU,IAAiBA,GAEhBjH,KAAED,OAEF,KAJD,GAAAuH,GAAA,EAAAA,EAAAR,EAAAQ,IAWC,GANDP,EAAKR,EAAAA,IAMDvG,KAAKuH,OAAOR,EAAIvE,IAAnB,CAJD,GAAAgF,GAAAT,EAAAzC,MAAA7C,CAMCuF,GAAK3B,KAAK,gBAAkB0B,EAAIvE,GAAK,KAAOgF,EAAU,oBAAsB,MAAQ,IAAMT,EAAIzC,KAAO,SAJtGtE,KAAIyH,KAAIH,EAAR9E,IAAmBsE,EAClBC,IACA/G,KAAGoG,WAAYW,EAAZvE,IAIHxC,KAAAuG,UAAY7G,KAAAsH,EAAAU,KAAA,QA1IalG,IAAA,OAAAC,MAAA,WAmJ1BzB,KAAK2H,SAAW,KAHhB3H,KAAAyF,OAAApB,MAAArE,KAAA4H,MAAA,GAAA5H,KAAAmG,mBAhJ0B3E,IAAA,MAAAC,MAAA,SAAAsF,GAmJ1B,MAAA/G,MAAK2H,OAALZ,EAAgBvE,KAOfxC,KAAKyF,OAAO9C,KAAK,YAAY,OAL9B1D,GAAAqD,MAAKmD,QAAL,KAIAzF,KAAGkF,IAAAG,KAAKkC,EAAOR,IACd/G,KAAAoF,MAAKK,OAAY,oCACjBzF,KAAAsE,KAAA,YAAAyC,EAAAvE,GAAA,iBAQkBuE,EAAIzC,KAAO,sEAG9BtE,MAAK4F,aAtKqBpE,IAAA,SAAAC,MAAA,SAsKrBmE,GACL,MAAA3G,GAAA4I,QAAArF,EAAAxC,KAAAkF,MAAA,KAvK0B1D,IAAA,UAAAC,MAAA,SAAAe,GA0K1BxC,KAAAyH,KAASI,IAAF7H,KAAc8H,IAAA9H,KAAdyH,KAAPjF,OA1K0BhB,IAAA,SAAAC,MAAA,WAqLzB,MArLyBzB,MAAAoG,WA8K1BpG,KAAKyH,QAALzH,KAAiBoG,YACjBpG,KAAAyF,OAAApB,OA/K0BrE,KAAAyF,OAAA9C,KAAA,YAAA,GAAA3C,KAAA4H,QAkL1B3I,EAAAqD,MAAG,SAAK8D,IAGFX,KArLoBjE,IAAA,SAAAC,MAAA,WAyLzBzB,KAAAyF,OAAAtF,SAODH,KAAKiE,QAAQQ,OALbzE,KAAAmG,mBA3L0B3E,IAAA,WAAAC,MAAA,WAAAzB,KAAAyF,OAAAxG,EAAAe,KAAAiF,kBAAAzD,IAAA,OAAAC,MAAA,SAiM1BqE,GAAKK,GAAAA,GAAAA,IACLlH,GAAA8I,MAlM0BtF,IAAAzC,KAAAyC,IAAAjD,KAAAP,EAAAM,MAAA+E,KAAAtE,KAAAyF,OAAApB,MAqM1ByB,KAAKL,IArMqB5C,OAAA,OAAAmF,SAAA,OAAApF,QAAA,SAAAE,GAwMhBA,EAAAC,OAETN,EAAKqD,EAAKrD,WADJ,OAAAK,EAAAtD,aAzMmBsF,IAiNzBlC,GAAAA,eAAS+B,KAAA,WACR,GAAAG,GAAGhC,SAGHrD,OAAAP","file":"Admin.min.js","sourcesContent":["/*!\n * admin\n * xiewulong <xiewulong@vip.qq.com>\n * create: 2016/8/2\n * version: 0.0.2\n */\n\n// csrf\n(($, document, undefined) => {\n\tlet param\t= $('meta[name=csrf-param]').attr('content'),\n\t\ttoken\t= $('meta[name=csrf-token]').attr('content');\n\n\t$.csrf = (data) => {\n\t\tdata = data || {};\n\t\tdata[param] = token;\n\n\t\treturn data;\n\t};\n\n})(jQuery, document);\n\n// modal\n(($, document, undefined) => {\n\n\t$.modal = (html, options) => {\n\t\t// html sample\n\t\t// '<div class=\"modal fade\">' +\n\t\t// \t'<div class=\"modal-dialog\">' +\n\t\t// \t\t'<div class=\"modal-content\">' +\n\t\t// \t\t\t'<div class=\"modal-header\">' +\n\t\t// \t\t\t\t'<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' +\n\t\t// \t\t\t\t'<h4 class=\"modal-title\">Modal title</h4>' +\n\t\t// \t\t\t'</div>' +\n\t\t// \t\t\t'<div class=\"modal-body\">' +\n\t\t// \t\t\t\t'<p>One fine body&hellip;</p>' +\n\t\t// \t\t\t'</div>' +\n\t\t// \t\t\t'<div class=\"modal-footer\">' +\n\t\t// \t\t\t\t'<button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>' +\n\t\t// \t\t\t\t'<button type=\"button\" class=\"btn btn-primary\">Save changes</button>' +\n\t\t// \t\t\t'</div>' +\n\t\t// \t\t'</div>' +\n\t\t// \t'</div>' +\n\t\t// '</div>';\n\n\t\treturn $(html).modal($.extend({backdrop: 'static'}, options)).on('shown.bs.modal', function() {\n\t\t\t$(this).find('[autofocus=autofocus]').focus();\n\t\t}).on('hidden.bs.modal', function() {\n\t\t\t$(this).remove();\n\t\t});\n\t};\n\n})(jQuery, document);\n\n// dropdown\n(($, document, undefined) => {\n\n\t$(document).on('click', '.J-admin-header .menu > ul.main > li > .text', function() {\n\t\tlet $li\t= $(this).parent('li');\n\n\t\tif(!$li.hasClass('dropdown-hover') && $li.find('ul.dropdown, ul.dropdown-mixed').length) {\n\t\t\t$li.toggleClass('dropdown-open');\n\n\t\t\treturn false;\n\t\t}\n\t}).on('click', function() {\n\t\t$('.J-admin-header .menu > ul.main > li.dropdown-open').removeClass('dropdown-open');\n\t});\n\n})(jQuery, document);\n\n// sidebar\n(($, document, undefined) => {\n\n\t$(document).on('click', '.J-admin-sidebar .sidebar-control', function() {\n\t\t$(this).parents('.J-admin-sidebar').toggleClass('admin-sidebar-fold');\n\t}).on('click', '.J-admin-sidebar ul.sidebar > li > .text', function() {\n\t\tlet $li\t= $(this).parent('li');\n\n\t\t$li.children('ul.children').length && $li.toggleClass('fold');\n\t});\n\n\t$('.J-admin-sidebar ul.sidebar > li > ul.children').each(function() {\n\t\tlet $this = $(this);\n\n\t\t$this.height($this.height());\n\t});\n\n})(jQuery, document);\n\n// alert\n(($, document, undefined) => {\n\tlet $alerts\t= $('.J-admin-alerts'),\n\t\ttypes\t= ['success', 'danger', 'info', 'warning'];\n\n\tclass Alert {\n\n\t\tconstructor(text, type, delay = 3000) {\n\t\t\tthis.text = text;\n\t\t\tthis.type = types[type];\n\t\t\tthis.delay = delay;\n\n\t\t\treturn this.init();\n\t\t}\n\n\t\tinit() {\n\t\t\tthis.render();\n\t\t\tthis.delayClose();\n\n\t\t\treturn this.$alert;\n\t\t}\n\n\t\trender() {\n\t\t\tlet _this\t= this;\n\n\t\t\tthis.$alert = $(\t'<div class=\"alert alert-' + this.type + ' alert-dismissible\">' +\n\t\t\t\t\t\t\t\t\t'<button type=\"button\" class=\"close\"><span>&times;</span></button>' +\n\t\t\t\t\t\t\t\t\tthis.text +\n\t\t\t\t\t\t\t\t'</div>').appendTo($alerts)\n\t\t\t\t.on('click', '.close', function() {\n\t\t\t\t\t_this.close();\n\t\t\t\t}).on('webkitTransitionend transitionend', function() {\n\t\t\t\t\t!_this.$alert.hasClass('alert-show') && _this.remove();\n\t\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.$alert.addClass('alert-show');\n\t\t\t}, 0);\n\t\t}\n\n\t\tdelayClose() {\n\t\t\tthis.timer = setTimeout(() => {\n\t\t\t\tthis.close();\n\t\t\t}, this.delay);\n\t\t}\n\n\t\tclose() {\n\t\t\tclearTimeout(this.timer);\n\t\t\tthis.$alert.removeClass('alert-show');\n\t\t}\n\n\t\tremove() {\n\t\t\tthis.$alert.remove();\n\t\t}\n\n\t}\n\n\t$.alert = function(text, type, delay) {\n\t\tif(type === undefined || type === true) {\n\t\t\ttype = 1;\n\t\t} else if(type === false) {\n\t\t\ttype = 0;\n\t\t}\n\n\t\treturn new Alert(text, type, delay);\n\t}\n\n})(jQuery, document);\n\n// delete modal\n(($, document, undefined) => {\n\n\t$(document).on('click', '[data-delete]', function() {\n\t\tlet deleted, $modal,\n\t\t\t$this\t= $(this),\n\t\t\tid\t\t= $this.attr('data-delete'),\n\t\t\turl\t\t= $this.attr('href') || $this.attr('data-url');\n\n\t\tif(!id || !url) return;\n\n\t\t$modal = $.modal(\t'<div class=\"modal fade\">' +\n\t\t\t\t\t\t\t\t'<div class=\"modal-dialog\">' +\n\t\t\t\t\t\t\t\t\t'<form class=\"modal-content\">' +\n\t\t\t\t\t\t\t\t\t\t'<fieldsed>' +\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"modal-header\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<h5 class=\"modal-title\">删除提示</h5>' +\n\t\t\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"modal-body\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<p>您确定要删除吗？</p>' +\n\t\t\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t\t\t\t'<div class=\"modal-footer\">' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">取消</button>' +\n\t\t\t\t\t\t\t\t\t\t\t\t'<button type=\"submit\" class=\"btn btn-primary\">确定</button>' +\n\t\t\t\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t\t\t\t'</fieldsed>' +\n\t\t\t\t\t\t\t\t\t'</form>' +\n\t\t\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t\t'</div>');\n\n\t\t$modal.on('submit', 'form', function() {\n\t\t\tlet $fieldset\t= $(this).find('fieldset').prop('disabled', true);\n\n\t\t\t$.ajax({\n\t\t\t\turl: url,\n\t\t\t\tdata: $.csrf({id: id}),\n\t\t\t\tmethod: 'post',\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess: (d) => {\n\t\t\t\t\tif(!d.error) {\n\t\t\t\t\t\tdeleted = true;\n\t\t\t\t\t}\n\t\t\t\t\t$modal.modal('hide');\n\t\t\t\t\t$.alert(d.message, d.error);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}).on('hidden.bs.modal', function() {\n\t\t\tdeleted && window.location.reload();\n\t\t});\n\n\t\treturn false;\n\t});\n\n})(jQuery, document);\n\n// attachment upload\n(($, document, undefined) => {\n\n\t$(document).on('uploaded.attachment.file', '.J-admin-attachment input[type=file]', function(e, d) {\n\t\tif(d.error) {\n\t\t\t$.alert(d.message);\n\n\t\t\treturn false;\n\t\t}\n\n\t\t$(this).parent().attr('data-attachment-max') === undefined ? _setData.call(this, d.data) : _new.call(this, d.data);\n\t\t$.alert(d.message, d.error);\n\t}).on('click', '.J-admin-attachment i', function() {\n\t\tlet $add, max,\n\t\t\t$parent\t= $(this).parent();\n\n\t\tif($parent.hasClass('admin-attachments')) {\n\t\t\t$add = $parent.siblings('[data-attachment-max]');\n\t\t\tmax = + $add.attr('data-attachment-max');\n\t\t\tmax > 0 && $parent.siblings('.admin-attachments').length < max && $add.show();\n\t\t\t$parent.remove();\n\n\t\t\treturn false;\n\t\t}\n\n\t\t$parent.find('input[type=hidden]').val('');\n\t\t$parent.find('img, i, p').remove();\n\t}).on('click', '[data-attachment-max]', function() {\n\t\tlet $this\t= $(this),\n\t\t\tmax\t\t= + $this.attr('data-attachment-max');\n\n\t\tif(max > 0 && $this.prevAll('.admin-attachments').length >= max) {\n\t\t\t$.alert('最多只能添加' + max + '张图片', 3);\n\n\t\t\treturn false;\n\t\t}\n\t});\n\n\t$('.J-admin-attachment').each(function() {\n\t\tlet $this\t= $(this),\n\t\t\t$hidden\t= $this.find('input[type=hidden]'),\n\t\t\t$file\t= $this.find('input[type=file]'),\n\t\t\tdata\t= {id: $hidden.val(), name: $hidden.attr('data-name')};\n\n\t\tdata.id && _setData.call($file.get(0), data);\n\t\t$this.hasClass('admin-attachment-name') && $this.append('<a href=\"javascript:;\">点击上传文件</a>');\n\t});\n\n\tfunction _new(data) {\n\t\tlet $this\t= $(this),\n\t\t\t$parent\t= $this.parent(),\n\t\t\tmax\t\t= + $parent.attr('data-attachment-max'),\n\t\t\t$new \t= $parent.clone().removeAttr('data-attachment-max').removeClass('glyphicon-plus').addClass('glyphicon-picture admin-attachments');\n\n\t\t_setData.call($new.find('input[type=file]').get(0), data, true);\n\t\t$parent.before($new);\n\t\tmax > 0 && $parent.siblings('.admin-attachments').length >= max && $parent.hide();\n\t}\n\n\tfunction _setData(data, isNew) {\n\t\tlet $this\t\t= $(this),\n\t\t\t$parent\t\t= $this.parent(),\n\t\t\t$hidden\t\t= $parent.find('input[type=hidden]'),\n\t\t\t$img\t\t= $parent.find('img'),\n\t\t\t$text\t\t= $parent.find('p'),\n\t\t\t$button\t\t= $parent.find('a'),\n\t\t\tnotImg\t\t= $parent.hasClass('admin-attachment-name');\n\n\t\tif(!$hidden.length) {\n\t\t\t$hidden = $('<input type=\"hidden\" name=\"' + $this.attr('data-attachment-upload') + '\" />').appendTo($parent);\n\t\t}\n\t\tif(!notImg && !$img.length) {\n\t\t\t$img = $('<img />').appendTo($parent);\n\t\t}\n\t\tif(!$parent.find('i').length) {\n\t\t\t$parent.append('<i class=\"glyphicon glyphicon-remove\"></i>');\n\t\t}\n\t\tif(notImg && !$text.length) {\n\t\t\t$text = $('<p></p>').appendTo($parent);\n\t\t}\n\t\t$hidden.val(data.id);\n\t\tif(notImg) {\n\t\t\t$hidden.attr('data-name', data.name);\n\t\t\t$text.html(data.name);\n\t\t} else {\n\t\t\t$img.attr('src', $this.attr('data-attachment-load-action') + '?id=' + data.id);\n\t\t}\n\t\tisNew && $this.remove();\n\t}\n\n})(jQuery, document);\n\n// tags\n(($, document, undefined) => {\n\n\tclass Tags {\n\n\t\tconstructor(obj) {\n\t\t\tthis.$obj = $(obj);\n\t\t\tthis.$list = this.$obj.find('p');\n\t\t\tthis.$new = this.$obj.find('.new');\n\t\t\tthis.$button = this.$new.find('button');\n\t\t\tthis.url = this.$obj.attr('data-tags');\n\t\t\tthis.name = this.$button.attr('data-tag-name');\n\t\t\tthis.inputTemplate = '<input type=\"text\" class=\"form-control\" placeholder=\"请输入标签名\" />';\n\t\t\tthis.ids = (() => {\n\t\t\t\tlet ids = [];\n\t\t\t\tthis.$list.find('span input[type=hidden]').each(function() {\n\t\t\t\t\tids.push(+ this.value);\n\t\t\t\t});\n\n\t\t\t\treturn ids;\n\t\t\t})();\n\n\t\t\tthis.events();\n\t\t}\n\n\t\tevents() {\n\t\t\tlet _this = this;\n\t\t\tthis.$obj.on('click', '.new button', () => {\n\t\t\t\tthis.newInput();\n\t\t\t\tthis.$button.hide();\n\t\t\t\tthis.$input.appendTo(this.$new).focus();\n\t\t\t}).on('keydown', '.new input', (e) => {\n\t\t\t\tswitch(e.originalEvent.keyCode) {\n\t\t\t\t\tcase 13:\n\t\t\t\t\t\treturn this.submit();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 27:\n\t\t\t\t\t\tthis.cancel();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 38:\n\t\t\t\t\t\tthis.press(false);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 40:\n\t\t\t\t\t\tthis.press(true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}).on('focus input', '.new input', () => {\n\t\t\t\tthis.like();\n\t\t\t}).on('click', 'p span i', function() {\n\t\t\t\tlet $span\t= $(this).parent('span'),\n\t\t\t\t\tindex\t= _this.ids.indexOf(+ $span.find('input[type=hidden]').val());\n\n\t\t\t\tindex >= 0 && _this.ids.splice(index, 1);\n\n\t\t\t\t$span.fadeOut(function() {\n\t\t\t\t\t$span.remove();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t$(document).on('click', () => {\n\t\t\t\tthis.clearDropdown();\n\t\t\t});\n\t\t}\n\n\t\tunselect() {\n\t\t\tthis.selectedId = null;\n\t\t}\n\n\t\tselect($target) {\n\t\t\tthis.selectedId = $target.addClass('selected').attr('data-id');\n\t\t}\n\n\t\tpress(down) {\n\t\t\tif(!this.$dropdown) return;\n\n\t\t\tlet $target,\n\t\t\t\tclassname\t= 'selected',\n\t\t\t\tsibling\t\t= down ? 'next' : 'prev',\n\t\t\t\t$selected\t= this.$dropdown.find('li.' + classname),\n\t\t\t\t$first\t\t= this.$dropdown.find('li:' + (down ? 'first' : 'last'));\n\n\t\t\tif($selected.length) {\n\t\t\t\t$selected.removeClass(classname);\n\n\t\t\t\tif($selected[sibling]('li').length) {\n\t\t\t\t\t$target = $selected[sibling]('li');\n\t\t\t\t} else {\n\t\t\t\t\t$target = $first;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$target = $first;\n\t\t\t}\n\n\t\t\tthis.select($target);\n\t\t}\n\n\t\tclearDropdown() {\n\t\t\tif(!this.$dropdown) return;\n\n\t\t\tthis.$dropdown.remove();\n\t\t\tthis.$dropdown = null;\n\t\t\tthis.pressDownIndex = 0;\n\t\t\tthis.unselect();\n\t\t}\n\n\t\tdropdown(tags) {\n\t\t\tlet len = tags.length;\n\n\t\t\tif(!len) {\n\t\t\t\tthis.clearDropdown();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.unselect();\n\n\t\t\tlet tag,\n\t\t\t\tlist\t= [],\n\t\t\t\tcss\t\t= this.$input.offset(),\n\t\t\t\tvalue\t= this.$input.val(),\n\t\t\t\t_this\t= this;\n\n\t\t\tcss.top += this.$input.get(0).offsetHeight;\n\n\t\t\tthis.$dropdown = this.$dropdown || $('<ul class=\"admin-tags-like-list\">').appendTo('body').on('click', 'li', function() {\n\t\t\t\t_this.addById($(this).attr('data-id'));\n\t\t\t}).on('mouseenter', 'li', function() {\n\t\t\t\t_this.selectedId = $(this).addClass('selected').siblings('.selected').removeClass('selected').end().attr('data-id');\n\t\t\t});\n\t\t\tthis.$dropdown.css(css);\n\n\t\t\tthis.tags = {};\n\n\t\t\tfor(let i = 0; i < len; i++) {\n\t\t\t\ttag = tags[i];\n\t\t\t\tif(this.exists(tag.id)) continue;\n\t\t\t\tlet current = tag.name == value;\n\t\t\t\tlist.push('<li data-id=\"' + tag.id + '\"' + (current ? ' class=\"selected\"' : null) + '>' + tag.name + '</li>');\n\t\t\t\tthis.tags[tag.id] = tag;\n\t\t\t\tif(current) {\n\t\t\t\t\tthis.selectedId = tag.id;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.$dropdown.html(list.join(''));\n\t\t}\n\n\t\tlike() {\n\t\t\tthis.selected = null;\n\n\t\t\tthis.$input.val() ? this.post(true) : this.clearDropdown();\n\t\t}\n\n\t\tadd(tag) {\n\t\t\tif(this.exists(tag.id)) {\n\t\t\t\tthis.$input.prop('disabled', false);\n\t\t\t\t$.alert('标签已添加', 3);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.ids.push(tag.id);\n\t\t\tthis.$list.append(\t'<span>' +\n\t\t\t\t\t\t\t\t\t'<input type=\"hidden\" name=\"' + this.name + '\" value=\"' + tag.id + '\" />\\n' +\n\t\t\t\t\t\t\t\t\t'<strong>' + tag.name + '</strong>\\n' +\n\t\t\t\t\t\t\t\t\t'<i class=\"glyphicon glyphicon-remove\"></i>\\n' +\n\t\t\t\t\t\t\t\t'</span>');\n\t\t\tthis.cancel();\n\t\t}\n\n\t\texists(id) {\n\t\t\treturn $.inArray(id, this.ids) >= 0;\n\t\t}\n\n\t\taddById(id) {\n\t\t\tthis.tags[id] && this.add(this.tags[id]);\n\t\t}\n\n\t\tsubmit() {\n\t\t\tif(this.selectedId) {\n\t\t\t\tthis.addById(this.selectedId);\n\t\t\t} else if(this.$input.val()) {\n\t\t\t\tthis.$input.prop('disabled', true);\n\t\t\t\tthis.post();\n\t\t\t} else {\n\t\t\t\t$.alert('请输入标签名', 3);\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\n\t\tcancel() {\n\t\t\tthis.$input.remove();\n\t\t\tthis.$button.show();\n\t\t\tthis.clearDropdown();\n\t\t}\n\n\t\tnewInput() {\n\t\t\tthis.$input = $(this.inputTemplate);\n\t\t}\n\n\t\tpost(like) {\n\t\t\t$.ajax({\n\t\t\t\turl: this.url,\n\t\t\t\tdata: $.csrf({\n\t\t\t\t\tname: this.$input.val(),\n\t\t\t\t\tlike: like,\n\t\t\t\t}),\n\t\t\t\tmethod: 'post',\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess: (d) => {\n\t\t\t\t\tif(d.error) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis[like ? 'dropdown' : 'add'](d.data);\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t}\n\n\t$('[data-tags]').each(function() {\n\t\tnew Tags(this);\n\t});\n\n})(jQuery, document);\n"],"sourceRoot":"/source/"}